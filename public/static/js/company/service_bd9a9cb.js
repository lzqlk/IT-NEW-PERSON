;/*!/dep/avalon/avalon.shim.js*/
!function(a,c){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?c(a,!0):function(a){if(!a.document)throw new Error("Avalon requires a window with a document");return c(a)}:c(a)}("undefined"!=typeof window?window:this,function(a,c){function v(){a.console&&avalon.config.debug&&Function.apply.call(console.log,console,arguments)}function h(){}function g(a,c){"string"==typeof a&&(a=a.match(Gt)||[]);for(var v={},h=void 0!==c?c:1,i=0,n=a.length;n>i;i++)v[a[i]]=h;return v}function y(){if(a.VBArray){var c=document.documentMode;return c?c:a.XMLHttpRequest?7:6}return 0/0}function b(a){return Zt.test(en.call(a))}function w(a,c){return a=Math.floor(a)||0,0>a?Math.max(c+a,0):Math.min(a,c)}function $(a){if(!a)return!1;var n=a.length;if(n===n>>>0){var c=en.call(a).slice(8,-1);if(/(?:regexp|string|function|window|global)$/i.test(c))return!1;if("Array"===c)return!0;try{return{}.propertyIsEnumerable.call(a,"length")===!1?/^\s?function/.test(a.item||a.callee):!0}catch(e){return!a.window}}return!1}function C(a,c,v){var h="for(var "+a+"i=0,n = this.length; i < n; i++){"+c.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+v;return Function("fn,scope",h)}function k(a,c){try{for(;c=c.parentNode;)if(c===a)return!0;return!1}catch(e){return!1}}function T(){return(new XMLSerializer).serializeToString(this)}function _(a,c){if(a&&a.childNodes)for(var v,h=a.childNodes,i=0;v=h[i++];)if(v.tagName){var g=Bt.createElementNS($n,v.tagName.toLowerCase());tn.forEach.call(v.attributes,function(a){g.setAttribute(a.name,a.value)}),_(v,g),c.appendChild(g)}}function E(a){var c={};for(var i in a)c[i]=a[i];var v=c.target=a.srcElement;if(0===a.type.indexOf("key"))c.which=null!=a.charCode?a.charCode:a.keyCode;else if(kn.test(a.type)){var h=v.ownerDocument||Bt,g="BackCompat"===h.compatMode?h.body:h.documentElement;c.pageX=a.clientX+(g.scrollLeft>>0)-(g.clientLeft>>0),c.pageY=a.clientY+(g.scrollTop>>0)-(g.clientTop>>0),c.wheelDeltaY=c.wheelDelta,c.wheelDeltaX=0}return c.timeStamp=new Date-0,c.originalEvent=a,c.preventDefault=function(){a.returnValue=!1},c.stopPropagation=function(){a.cancelBubble=!0},c}function A(a){for(var p in a)if(Qt.call(a,p)){var c=a[p];"function"==typeof A.plugins[p]?A.plugins[p](c):"object"==typeof A[p]?avalon.mix(A[p],c):A[p]=c}return this}function O(a){return(a+"").replace(jn,"\\$&")}function M(a,c,v){if(Array.isArray(a)){var h=a.concat();a.length=0;var g=B(a);return g.pushArray(h),g}if(!a||a.nodeType>0||a.$id&&a.$events)return a;var y=Array.isArray(a.$skipArray)?a.$skipArray:[];y.$special=c||{};var b={};v=v||{};var w={},$={},C=[];Bn.forEach(function(c){delete a[c]});var k=Object.keys(a);k.forEach(function(c,h){var g=a[c];if(v[c]=g,P(c,g,y)){w[c]=[];var b=avalon.type(g);"object"===b&&fn(g.get)&&Object.keys(g).length<=2?(h=S(c,g),C.push(h)):h=Ut.test(b)?j(c,g,b,w[c]):N(c,g),$[c]=h}}),b=Vn(b,Xn($),a);for(var i=0;i<k.length;i++){var T=k[i];$[T]||(b[T]=a[T])}b.$propertyNames=k.sort().join("&shy;"),b.$id=cn(),b.$model=v,b.$events=w;for(i in Pn){var _=Pn[i];rn||(_=_.bind(b)),b[i]=_}return Rn?Object.defineProperty(b,"hasOwnProperty",zn):b.hasOwnProperty=function(a){return a in b.$model},b.$reinitialize=function(){C.forEach(function(a){delete a._value,delete a.oldArgs,a.digest=function(){a.call(b)},Un.begin({callback:function(c,v){var h=v._name;if(v!==a){var g=c.$events[h];V(g,a.digest)}}});try{a.get.call(b)}finally{Un.end()}})},b.$reinitialize(),b}function N(a,c){function v(a){var c=v._value;return arguments.length>0?(qt||Wn(a,c)||(v.updateValue(this,a),v.notify(this,a,c)),this):(Un.collectDependency(this,v),c)}return H(v,a),v._value=c,v}function S(a,c){function v(c){var h=v._value,g="_value"in v;if(arguments.length>0){if(qt)return this;if("function"==typeof v.set&&v.oldArgs!==c){v.oldArgs=c;var y=this.$events,b=y[a];y[a]=[],v.set.call(this,c),y[a]=b,c=v.get.call(this),c!==h&&(v.updateValue(this,c),v.notify(this,c,h))}return this}return c=v.get.call(this),v.updateValue(this,c),g&&h!==c&&v.notify(this,c,h),c}return v.set=c.set,v.get=c.get,H(v,a),v}function j(a,c,v,h){function g(c){var h=g._value,y=g._vmodel;if(arguments.length>0){if(qt)return this;if("array"===v){var b=y,w=c,$=b.length,C=w.length;b.$lock=!0,$>C?b.splice(C,$-C):C>$&&b.push.apply(b,w.slice($));for(var n=Math.min($,C),i=0;n>i;i++)b.set(i,w[i]);delete b.$lock,b._fire("set")}else if("object"===v){var k=Object.keys(c).sort().join("&shy;");if(y.$propertyNames===k)for(i in c)y[i]=c[i];else if(rn){var b=g._vmodel=M(c);b.$events=y.$events}else{var T=y.$proxy;y=g._vmodel=M(c);var _=y.$events[Wt]=this.$events[a]||[],E=_.concat();for(_.length=0,y.$proxy=T;b=E.shift();){var A=vn[b.type];A&&(b.rollback&&b.rollback(),A(b,b.vmodels))}}}return g.updateValue(this,y.$model),g.notify(this,this._value,h),this}return Un.collectDependency(this,g),y}H(g,a);var y=g._vmodel=M(c);return y.$events[Wt]=h,g}function L(a,c){a.$model[this._name]=this._value=c}function D(a,c,v){var h=this._name,g=a.$events[h];g&&(z(g),Pn.$fire.call(a,h,c,v))}function H(a,c){a._name=c,a.updateValue=L,a.notify=D}function P(a,c,v){if(fn(c)||c&&c.nodeType)return!1;if(-1!==v.indexOf(a))return!1;var h=v.$special;return a&&"$"===a.charAt(0)&&!h[a]?!1:!0}function F(a,c,v,h){var g=c[v];return 4!==arguments.length?g.call(a):void g.call(a,h)}function B(a){var c=[];c.$id=cn(),c.$model=a,c.$events={},c.$events[Wt]=[],c._=M({length:a.length}),c._.$watch("length",function(a,v){c.$fire("length",a,v)});for(var i in Pn)c[i]=Pn[i];return avalon.mix(c,Gn),c}function I(a,c,n,v,h,g,y){for(var b=this.length,w=2;--w;){switch(a){case"add":var $=this.$model.slice(c,c+n).map(function(a){return Ut.test(avalon.type(a))?a.$id?a:M(a,0,a):a});qn.apply(this,[c,0].concat($)),this._fire("add",c,n);break;case"del":var C=this._splice(c,n);this._fire("del",c,n)}h&&(a=h,c=g,n=y,w=2,h=0)}return this._fire("index",v),this.length!==b&&(this._.length=this.length),C}function R(a,c){for(var v={},i=0,n=c.length;n>i;i++){v[i]=a[i];var h=c[i];h in v?(a[i]=v[h],delete v[h]):a[i]=a[h]}}function V(a,c){c.oneTime||a&&avalon.Array.ensure(a,c)&&c.element&&X(c,a)}function z(a){if(a&&a.length){new Date-Qn>444&&"object"==typeof a[0]&&Y();for(var c,v=nn.call(arguments,1),i=a.length;c=a[--i];){var g=c.element;if(g&&g.parentNode)try{if(c.$repeat)c.handler.apply(c,v);else if("on"!==c.type){var y=c.evaluator||h;c.handler(y.apply(0,c.args||[]),g,c)}}catch(e){}}}}function W(a,c){return a.uuid||c||(a.uuid=++Zn,tr[a.uuid]=a),a.uuid}function X(a,c){var v=a.element;a.uuid||(a.uuid=1!==v.nodeType?a.type+(a.pos||0)+"-"+W(v.parentNode):a.name+"-"+W(v));var h=a.lists||(a.lists=[]);avalon.Array.ensure(h,c),c.$uuid=c.$uuid||cn(),Kn[a.uuid]||(Kn[a.uuid]=1,Kn.push(a))}function Y(a){if(!avalon.optimize){for(var i=Kn.length,n=i,c=[],v={},h={};a=Kn[--i];){var g=a.type;h[g]?h[g]++:(h[g]=1,c.push(g))}var y=!1;if(c.forEach(function(a){er[a]!==h[a]&&(v[a]=1,y=!0)}),i=n,y)for(;a=Kn[--i];)if(a.element&&v[a.type]&&U(a.element)){Kn.splice(i,1),delete Kn[a.uuid],delete tr[a.element.uuid];for(var b,w=a.lists,$=0;b=w[$++];)avalon.Array.remove(w,b),avalon.Array.remove(b,a);G(a)}er=h,Qn=new Date}}function G(a){a.element=null,a.rollback&&a.rollback();for(var c in a)a[c]=null}function U(a){try{if(!a.parentNode)return!0}catch(e){return!0}return a.msRetain?0:1===a.nodeType?!an.contains(a):!avalon.contains(an,a)}function J(a){var c=a.nodeName;return c.toLowerCase()===c&&a.scopeName&&""===a.outerText}function Z(a){"url(#default#VML)"!==a.currentStyle.behavior&&(a.style.behavior="url(#default#VML)",a.style.display="inline-block",a.style.zoom=1)}function K(a){return a.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function Q(a){return!a||a.indexOf("-")<0&&a.indexOf("_")<0?a:a.replace(/[-_][^-_]/g,function(a){return a.charAt(1).toUpperCase()})}function et(a){if(!("classList"in a)){a.classList={node:a};for(var c in pr)a.classList[c.slice(1)]=pr[c]}return a.classList}function tt(a){try{if("object"==typeof a)return a;a="true"===a?!0:"false"===a?!1:"null"===a?null:+a+""===a?+a:dr.test(a)?avalon.parseJSON(a):a}catch(e){}return a}function nt(a){return a.window&&a.document?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}function at(a,c){if(a.offsetWidth<=0){if(Ar.test(yr["@:get"](a,"display"))){var v={node:a};for(var h in Er)v[h]=a.style[h],a.style[h]=Er[h];c.push(v)}var g=a.parentNode;g&&1===g.nodeType&&at(g,c)}}function it(a){var c=a.tagName.toLowerCase();return"input"===c&&/checkbox|radio/.test(a.type)?"checked":c}function ot(a,c,v,h){for(var g,y=[],b=" = "+v+".",i=a.length;g=a[--i];)c.hasOwnProperty(g)&&(y.push(g+b+g),h.vars.push(g),"duplex"===h.type&&(a.get=v+"."+g),a.splice(i,1));return y}function lt(a){for(var c=[],v={},i=0;i<a.length;i++){var h=a[i],g=h&&"string"==typeof h.$id?h.$id:h;v[g]||(v[g]=c.push(h))}return c}function st(a,c){return c=c.replace(Wr,"").replace(Xr,function(){return"],|"}).replace(Yr,function(a,c){return"["+Sr(c)}).replace(qr,function(){return'"],["'}).replace(Gr,function(){return'",'})+"]","return avalon.filters.$filter("+a+", "+c+")"}function ct(a,c,g){var y=g.type,b=g.filters||"",w=c.map(function(a){return String(a.$id).replace(zr,"$1")})+a+y+b,$=Ir(a).concat(),C=[],k=[],T=[],_="";c=lt(c),g.vars=[];for(var i=0,E=c.length;E>i;i++)if($.length){var A="vm"+Ft+"_"+i;k.push(A),T.push(c[i]),C.push.apply(C,ot($,c[i],A,g))}if(C.length||"duplex"!==y){"duplex"!==y&&(a.indexOf("||")>-1||a.indexOf("&&")>-1)&&g.vars.forEach(function(c){var v=new RegExp("\\b"+c+"(?:\\.\\w+|\\[\\w+\\])+","ig");a=a.replace(v,function(v){var h=v.charAt(c.length),r=un?a.slice(arguments[1]+v.length):RegExp.rightContext,g=/^\s*\(/.test(r);if("."===h||"["===h||g){var y="var"+String(Math.random()).replace(/^0\./,"");if(g){var b=v.split(".");if(b.length>2){var w=b.pop();return C.push(y+" = "+b.join(".")),y+"."+w}return v}return C.push(y+" = "+v),y}return v})}),g.args=T,delete g.vars;var O=Rr.get(w);if(O)return void(g.evaluator=O);if(_=C.join(", "),_&&(_="var "+_),/\S/.test(b)){if(!/text|html/.test(g.type))throw Error("ms-"+g.type+"不支持过滤器");a="\nvar ret"+Ft+" = "+a+";\r\n",a+=st("ret"+Ft,b)}else{if("duplex"===y){var M="'use strict';\nreturn function(vvv){\n	"+_+";\n	if(!arguments.length){\n		return "+a+"\n	}\n	"+(Vr.test(a)?a:$.get)+"= vvv;\n} ";try{O=Function.apply(h,k.concat(M)),g.evaluator=Rr.put(w,O)}catch(e){v("debug: parse error,"+e.message)}return}if("on"===y){-1===a.indexOf("(")?a+=".call(this, $event)":a=a.replace("(",".call(this,"),k.push("$event"),a="\nreturn "+a+";";var N=a.lastIndexOf("\nreturn"),S=a.slice(0,N),j=a.slice(N);a=S+"\n"+j}else a="\nreturn "+a+";"}try{O=Function.apply(h,k.concat("'use strict';\n"+_+a)),g.evaluator=Rr.put(w,O)}catch(e){v("debug: parse error,"+e.message)}finally{$=C=k=null}}}function ut(a,c,v,h,g){Array.isArray(h)&&(a=h.map(function(a){return a.expr?"("+a.value+")":Sr(a.value)}).join(" + ")),ct(a,c,v),v.evaluator&&!g&&(v.handler=hn[v.handlerName||v.type],avalon.injectBinding(v))}function ft(a,c,v){var h=setTimeout(function(){var g=a.innerHTML;clearTimeout(h),g===v?c():ft(a,c,g)})}function pt(a,c){var v=a.getAttribute("avalonctrl")||c.$id;a.setAttribute("avalonctrl",v),c.$events.expr=a.tagName+'[avalonctrl="'+v+'"]'}function dt(a,c){for(var v,i=0;v=a[i++];)v.vmodels=c,vn[v.type](v,c),v.evaluator&&v.element&&1===v.element.nodeType&&v.element.removeAttribute(v.name);a.length=0}function vt(a,c){return a.priority-c.priority}function ht(a,c,h){var g=!0;if(c.length){for(var y,b=ua?ua(a):a.attributes,w=[],$=[],C={},i=0;y=b[i++];)if(y.specified&&(h=y.name.match(Qr))){var k=h[1],T=h[2]||"",_=y.value,E=y.name;if(ta[k]?(T=k,k="on"):na[k]&&("enabled"===k&&(v("warning!ms-enabled或ms-attr-enabled已经被废弃"),k="disabled",_="!("+_+")"),T=k,k="attr",E="ms-"+k+"-"+T,$.push([y.name,E,_])),C[E]=_,"function"==typeof vn[k]){var A=_.replace(Kr,""),O=_!==A,M={type:k,param:T,element:a,name:E,value:A,oneTime:O,uuid:E+"-"+W(a),priority:(ea[k]||10*k.charCodeAt(0))+(Number(T.replace(/\D/g,""))||0)};if("html"===k||"text"===k){var N=bt(_);avalon.mix(M,N),M.filters=M.filters.replace(fa,function(){return M.type="html",M.group=1,""})}else if("duplex"===k)var S=E;else"ms-if-loop"===E&&(M.priority+=100);w.push(M),"widget"===k&&(a.msData=a.msData||C)}}if(w.length){for(w.sort(vt),$.forEach(function(c){v("warning!请改用"+c[1]+"代替"+c[0]+"!"),a.removeAttribute(c[0]),a.setAttribute(c[1],c[2])}),S&&(C["ms-attr-checked"]&&v("warning!一个控件不能同时定义ms-attr-checked与"+S),C["ms-attr-value"]&&v("warning!一个控件不能同时定义ms-attr-value与"+S)),i=0;M=w[i];i++){if(k=M.type,ra.test(k))return dt(w.slice(0,i+1),c);g&&(g=!aa.test(k))}dt(w,c)}}g&&!Ur[a.tagName]&&Sn.test(a.innerHTML.replace(da,"<").replace(va,">"))&&(Zr&&Zr(a),mt(a,c))}function mt(a,c){var v=avalon.slice(a.childNodes);gt(v,c)}function gt(a,c){for(var v,i=0;v=a[i++];)switch(v.nodeType){case 1:yt(v,c),v.msCallback&&(v.msCallback(),v.msCallback=void 0);break;case 3:Mn.test(v.nodeValue)&&wt(v,c,i)}}function yt(a,c,h){var g=a.getAttribute("ms-skip");if(!a.getAttributeNode)return v("warning "+a.tagName+" no getAttributeNode method");var y=a.getAttributeNode("ms-important"),b=a.getAttributeNode("ms-controller");if("string"!=typeof g){if(h=y||b){var w=avalon.vmodels[h.value];if(!w)return;c=h===y?[w]:[w].concat(c);var $=h.name;a.removeAttribute($),avalon(a).removeClass($),pt(a,w)}ht(a,c)}}function bt(a){if(a.indexOf("|")>0){var c=a.replace(ha,function(a){return Array(a.length+1).join("1")}),v=c.replace(pa,"ᄢ㍄").indexOf("|");if(v>-1)return{filters:a.slice(v),value:a.slice(0,v),expr:!0}}return{value:a,filters:"",expr:!0}}function xt(a){for(var c,v,h=[],g=0;;){if(v=a.indexOf(An,g),-1===v)break;if(c=a.slice(g,v),c&&h.push({value:c,filters:"",expr:!1}),g=v+An.length,v=a.indexOf(On,g),-1===v)break;c=a.slice(g,v),c&&h.push(bt(c,g)),g=v+On.length}return c=a.slice(g),c&&h.push({value:c,expr:!1,filters:""}),h}function wt(a,c,v){var h=[];if(tokens=xt(a.data),tokens.length){for(var i=0;token=tokens[i++];){var g=Bt.createTextNode(token.value);token.expr&&(token.value=token.value.replace(Kr,function(){return token.oneTime=!0,""}),token.type="text",token.element=g,token.filters=token.filters.replace(fa,function(){return token.type="html",""}),token.pos=1e3*v+i,h.push(token)),on.appendChild(g)}a.parentNode.replaceChild(on,a),h.length&&dt(h,c)}}function $t(a,c,v){var h=a.templateCache&&a.templateCache[c];if(h){for(var g,y=Bt.createDocumentFragment();g=h.firstChild;)y.appendChild(g);return y}return avalon.parseHTML(v)}function Ct(a){return null==a?"":a}function kt(a,c,v){return c.param.replace(/\w+/g,function(h){var g=avalon.duplexHooks[h];g&&"function"==typeof g[v]&&(a=g[v](a,c))}),a}function Tt(){for(var n=_a.length-1;n>=0;n--){var a=_a[n];a()===!1&&_a.splice(n,1)}_a.length||clearInterval(Ta)}function _t(a,c,v,h){var g=a.template.cloneNode(!0),y=avalon.slice(g.childNodes);a.$with||g.insertBefore(Bt.createComment(a.signature),g.firstChild),c.appendChild(g);var b=[v].concat(a.vmodels),w={nodes:y,vmodels:b};h.push(w)}function Et(a){for(var c=a.element,v=c.nodeValue.replace(":end",""),h=c.previousSibling,g=[];h;)h.nodeValue===v&&g.unshift(h),h=h.previousSibling;return g}function At(a,c,v){for(;;){var h=c.previousSibling;if(!h)break;if(h.parentNode.removeChild(h),v&&v.call(h),h===a)break}}function Ot(){var a=M({$key:"",$outer:{},$host:{},$val:{get:function(){return this.$host[this.$key]},set:function(a){this.$host[this.$key]=a}}},{$val:1});return a.$id=cn("$proxy$with"),a}function Mt(a,c,v){a=a||Ma.pop(),a?a.$reinitialize():a=Ot();var h=v.$repeat;return a.$key=c,a.$host=h,a.$outer=v.$outer,h.$events?a.$events.$val=h.$events[c]:a.$events={},a}function Nt(a){St(a)}function St(a){a.forEach(function(a){Dt(a,Na)}),a.length=0}function jt(a){var c={$host:[],$outer:{},$index:0,$first:!1,$last:!1,$remove:avalon.noop};c[a]={get:function(){var e=this.$events,c=e.$index;e.$index=e[a];try{return this.$host[this.$index]}finally{e.$index=c}},set:function(a){try{var e=this.$events,c=e.$index;e.$index=[],this.$host.set(this.$index,a)}finally{e.$index=c}}};var v={$last:1,$first:1,$index:1},h=M(c,v);return h.$id=cn("$proxy$each"),h}function Lt(a,c){for(var v,h=c.param||"el",i=0,n=Na.length;n>i;i++){var g=Na[i];g&&g.hasOwnProperty(h)&&(v=g,Na.splice(i,1))}v||(v=jt(h));var y=c.$repeat,b=y.length-1;return v.$index=a,v.$first=0===a,v.$last=a===b,v.$host=y,v.$outer=c.$outer,v.$remove=function(){return y.removeAt(v.$index)},v}function Dt(a,c){for(var i in a.$events)Array.isArray(a.$events[i])&&(a.$events[i].forEach(function(a){"object"==typeof a&&G(a)}),a.$events[i].length=0);a.$host=a.$outer={},c.unshift(a)>A.maxRepeatSize&&c.pop()}function Ht(a,c){var v="_"+a;if(!Ht[v]){var h=Bt.createElement(a);an.appendChild(h),c=rn?getComputedStyle(h,null).display:h.currentStyle.display,an.removeChild(h),Ht[v]=c}return Ht[v]}function Pt(a,c,v,h){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var n=isFinite(+a)?+a:0,g=isFinite(+c)?Math.abs(c):3,y=h||",",b=v||".",s="",w=function(n,a){var c=Math.pow(10,a);return""+(Math.round(n*c)/c).toFixed(a)};return s=(g?w(n,g):""+Math.round(n)).split("."),s[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,y)),(s[1]||"").length<g&&(s[1]=s[1]||"",s[1]+=new Array(g-s[1].length+1).join("0")),s.join(b)}var Ft=new Date-0,Bt=a.document,It=Bt.getElementsByTagName("head")[0],Rt=It.insertBefore(document.createElement("avalon"),It.firstChild);Rt.innerHTML="X<style id='avalonStyle'>.avalonHide{ display: none!important }</style>",Rt.setAttribute("ms-skip","1"),Rt.className="avalonHide";var Vt,zt=/\[native code\]/,Wt="$"+Ft,Xt=a.require,Yt=a.define,qt=!1,Gt=/[^, ]+/g,Ut=/^(?:object|array)$/,Jt=/^\[object SVG\w*Element\]$/,Zt=/^\[object (?:Window|DOMWindow|global)\]$/,Kt=Object.prototype,Qt=Kt.hasOwnProperty,en=Kt.toString,tn=Array.prototype,nn=tn.slice,rn=a.dispatchEvent,an=Bt.documentElement,on=Bt.createDocumentFragment(),ln=Bt.createElement("div"),sn={};"Boolean Number String Function Array Date RegExp Object Error".replace(Gt,function(a){sn["[object "+a+"]"]=a.toLowerCase()});var cn=function(a){return a=a||"avalon",String(Math.random()+Math.random()).replace(/\d\.\d{4}/,a)},un=y();avalon=function(a){return new avalon.init(a)},avalon.profile=function(){a.console&&avalon.config.profile&&Function.apply.call(console.log,console,arguments)},avalon.nextTick=new function(){function c(){for(var n=y.length,i=0;n>i;i++)y[i]();y=y.slice(n)}var v=a.setImmediate,h=a.MutationObserver,g=rn&&a.postMessage;if(v)return v.bind(a);var y=[];if(h){var b=document.createTextNode("avalon");return new h(c).observe(b,{characterData:!0}),function(a){y.push(a),b.data=Math.random()}}return g?(a.addEventListener("message",function(e){var v=e.source;v!==a&&null!==v||"process-tick"!==e.data||(e.stopPropagation(),c())}),function(c){y.push(c),a.postMessage("process-tick","*")}):function(a){setTimeout(a,0)}},avalon.init=function(a){this[0]=this.element=a},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?sn[en.call(a)]||"object":typeof a};var fn="object"==typeof alert?function(a){try{return/^\s*\bfunction\b/.test(a+"")}catch(e){return!1}}:function(a){return"[object Function]"===en.call(a)};avalon.isFunction=fn,avalon.isWindow=function(a){return a?a==a.document&&a.document!=a:!1},b(a)&&(avalon.isWindow=b);var pn;for(pn in avalon({}))break;var dn="0"!==pn;avalon.isPlainObject=function(a,c){if(!a||"object"!==avalon.type(a)||a.nodeType||avalon.isWindow(a))return!1;try{if(a.constructor&&!Qt.call(a,"constructor")&&!Qt.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(dn)for(c in a)return Qt.call(a,c);for(c in a);return void 0===c||Qt.call(a,c)},zt.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(a){return"[object Object]"===en.call(a)&&Object.getPrototypeOf(a)===Kt}),avalon.mix=avalon.fn.mix=function(){var a,c,v,h,g,y,b=arguments[0]||{},i=1,w=arguments.length,$=!1;for("boolean"==typeof b&&($=b,b=arguments[1]||{},i++),"object"==typeof b||fn(b)||(b={}),i===w&&(b=this,i--);w>i;i++)if(null!=(a=arguments[i]))for(c in a){v=b[c];try{h=a[c]}catch(e){continue}b!==h&&($&&h&&(avalon.isPlainObject(h)||(g=Array.isArray(h)))?(g?(g=!1,y=v&&Array.isArray(v)?v:[]):y=v&&avalon.isPlainObject(v)?v:{},b[c]=avalon.mix($,y,h)):void 0!==h&&(b[c]=h))}return b},avalon.mix({rword:Gt,subscribers:Wt,version:1.45,ui:{},log:v,slice:rn?function(a,c,v){return nn.call(a,c,v)}:function(a,c,v){var h=[],g=a.length;if(void 0===v&&(v=g),"number"==typeof v&&isFinite(v)){c=w(c,g),v=w(v,g);for(var i=c;v>i;++i)h[i-c]=a[i]}return h},noop:h,error:function(a,e){throw(e||Error)(a)},oneObject:g,range:function(a,c,v){v||(v=1),null==c&&(c=a||0,a=0);for(var h=-1,g=Math.max(0,Math.ceil((c-a)/v)),y=new Array(g);++h<g;)y[h]=a,a+=v;return y},eventHooks:[],bind:function(a,c,v,h){var g=avalon.eventHooks,y=g[c];"object"==typeof y&&(c=y.type,y.deel&&(v=y.deel(a,c,v,h)));var b=rn?v:function(e){v.call(a,E(e))};return rn?a.addEventListener(c,b,!!h):a.attachEvent("on"+c,b),b},unbind:function(a,c,v,g){var y=avalon.eventHooks,b=y[c],w=v||h;"object"==typeof b&&(c=b.type,b.deel&&(v=b.deel(a,c,v,!1))),rn?a.removeEventListener(c,w,!!g):a.detachEvent("on"+c,w)},css:function(a,c,v){a instanceof avalon&&(a=a[0]);var h,g=/[_-]/.test(c)?Q(c):c;if(c=avalon.cssName(g)||g,void 0===v||"boolean"==typeof v){h=yr[g+":get"]||yr["@:get"],"background"===c&&(c="backgroundColor");var y=h(a,c);return v===!0?parseFloat(y)||0:y}if(""===v)a.style[c]="";else{if(null==v||v!==v)return;isFinite(v)&&!avalon.cssNumber[g]&&(v+="px"),h=yr[g+":set"]||yr["@:set"],h(a,c,v)}},each:function(a,c){if(a){var i=0;if($(a))for(var n=a.length;n>i&&c(i,a[i])!==!1;i++);else for(i in a)if(a.hasOwnProperty(i)&&c(i,a[i])===!1)break}},getWidgetData:function(a,c){var v=avalon(a).data(),h={};for(var i in v)0===i.indexOf(c)&&(h[i.replace(c,"").replace(/\w/,function(a){return a.toLowerCase()})]=v[i]);return h},Array:{ensure:function(a,c){return-1===a.indexOf(c)?a.push(c):void 0},removeAt:function(a,c){return!!a.splice(c,1).length},remove:function(a,c){var v=a.indexOf(c);return~v?avalon.Array.removeAt(a,v):!1}}});var vn=avalon.bindingHandlers={},hn=avalon.bindingExecutors={},mn=new function(){function a(a){this.size=0,this.limit=a,this.head=this.tail=void 0,this._keymap={}}var p=a.prototype;return p.put=function(a,c){var v={key:a,value:c};return this._keymap[a]=v,this.tail?(this.tail.newer=v,v.older=this.tail):this.head=v,this.tail=v,this.size===this.limit?this.shift():this.size++,c},p.shift=function(){var a=this.head;a&&(this.head=this.head.newer,this.head.older=a.newer=a.older=this._keymap[a.key]=void 0)},p.get=function(a){var c=this._keymap[a];if(void 0!==c)return c===this.tail?c.value:(c.newer&&(c===this.head&&(this.head=c.newer),c.newer.older=c.older),c.older&&(c.older.newer=c.newer),c.newer=void 0,c.older=this.tail,this.tail&&(this.tail.newer=c),this.tail=c,c.value)},a};if(!"司徒正美".trim){var gn=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(gn,"")}}var yn=!{toString:null}.propertyIsEnumerable("toString"),bn=function(){}.propertyIsEnumerable("prototype"),xn=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],wn=xn.length;if(Object.keys||(Object.keys=function(a){var c=[],v=bn&&"function"==typeof a;if("string"==typeof a||a&&a.callee)for(var i=0;i<a.length;++i)c.push(String(i));else for(var h in a)v&&"prototype"===h||!Qt.call(a,h)||c.push(String(h));if(yn)for(var g=a.constructor,y=g&&g.prototype===a,b=0;wn>b;b++){var w=xn[b];y&&"constructor"===w||!Qt.call(a,w)||c.push(w)}return c}),Array.isArray||(Array.isArray=function(a){return"[object Array]"===en.call(a)}),h.bind||(Function.prototype.bind=function(a){if(arguments.length<2&&void 0===a)return this;var c=this,v=arguments;return function(){var i,h=[];for(i=1;i<v.length;i++)h.push(v[i]);for(i=0;i<arguments.length;i++)h.push(arguments[i]);return c.apply(a,h)}}),zt.test([].map)||avalon.mix(tn,{indexOf:function(a,c){var n=this.length,i=~~c;for(0>i&&(i+=n);n>i;i++)if(this[i]===a)return i;return-1},lastIndexOf:function(a,c){var n=this.length,i=null==c?n-1:c;for(0>i&&(i=Math.max(0,n+i));i>=0;i--)if(this[i]===a)return i;return-1},forEach:C("","_",""),filter:C("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:C("r=[],","r[i]=_","return r"),some:C("","if(_)return true","return false"),every:C("","if(!_)return false","return true")}),avalon.contains=k,Bt.contains||(Bt.contains=function(a){return k(Bt,a)}),a.SVGElement){Bt.createTextNode("x").contains||(Node.prototype.contains=function(a){return!!(16&this.compareDocumentPosition(a))});var $n="http://www.w3.org/2000/svg",Cn=Bt.createElementNS($n,"svg");Cn.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />',Jt.test(Cn.firstChild)||Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:T,set:function(a){var c=this.tagName.toLowerCase(),v=this.parentNode,h=avalon.parseHTML(a);if("svg"===c)v.insertBefore(h,this);else{var g=Bt.createDocumentFragment();_(h,g),v.insertBefore(g,this)}v.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var s=this.outerHTML,a=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),c=new RegExp("</"+this.nodeName+">$","i");return s.replace(a,"").replace(c,"")},set:function(a){if(avalon.clearHTML){avalon.clearHTML(this);var c=avalon.parseHTML(a);_(c,this)}}}})}!an.outerHTML&&a.HTMLElement&&HTMLElement.prototype.__defineGetter__("outerHTML",T);var kn=/^(?:mouse|contextmenu|drag)|click/,Tn=avalon.eventHooks;if("onmouseenter"in an||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,c){Tn[a]={type:c,deel:function(c,v,h){return function(e){var t=e.relatedTarget;return t&&(t===c||16&c.compareDocumentPosition(t))?void 0:(delete e.type,e.type=a,h.call(c,e))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(c,v){a[c]&&!Tn.animationend&&(Tn.animationend={type:v})}),"oninput"in Bt.createElement("input")||(Tn.input={type:"propertychange",deel:function(a,c,v){return function(e){return"value"===e.propertyName?(e.type="input",v.call(a,e)):void 0}}}),void 0===Bt.onmousewheel){var _n=void 0!==Bt.onwheel?"wheel":"DOMMouseScroll",En="wheel"===_n?"deltaY":"detail";Tn.mousewheel={type:_n,deel:function(a,c,v){return function(e){e.wheelDeltaY=e.wheelDelta=e[En]>0?-120:120,e.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(e,"type",{value:"mousewheel"}),v.call(a,e)}}}}var An,On,Mn,Nn,Sn,jn=/[-.*+?^${}()|[\]\/\\]/g,Ln={loader:function(c){var v=Vt&&c;a.require=v?Vt:Xt,a.define=v?Vt.define:Yt},interpolate:function(a){if(An=a[0],On=a[1],An===On){throw new SyntaxError("openTag!==closeTag")}var o=O(An),c=O(On);Mn=new RegExp(o+"(.*?)"+c),Nn=new RegExp(o+"(.*?)"+c,"g"),Sn=new RegExp(o+".*?"+c+"|\\sms-")}};A.debug=!0,A.plugins=Ln,A.plugins.interpolate(["{{","}}"]),A.paths={},A.shim={},A.maxRepeatSize=100,avalon.config=A;var Dn=/(\w+)\[(avalonctrl)="(\S+)"\]/,Hn=Bt.querySelectorAll?function(a){return Bt.querySelectorAll(a)}:function(a){for(var c,v=a.match(Dn),h=Bt.getElementsByTagName(v[1]),g=[],i=0;c=h[i++];)c.getAttribute(v[2])===v[3]&&g.push(c);return g},Pn={$watch:function(a,c){if("function"==typeof c){var v=this.$events[a];v?v.push(c):this.$events[a]=[c]}else this.$events=this.$watch.backup;return this},$unwatch:function(a,c){var n=arguments.length;if(0===n)this.$watch.backup=this.$events,this.$events={};else if(1===n)this.$events[a]=[];else for(var v=this.$events[a]||[],i=v.length;~--i<0;)if(v[i]===c)return v.splice(i,1);return this},$fire:function(a){var c,i,v,h;/^(\w+)!(\S+)$/.test(a)&&(c=RegExp.$1,a=RegExp.$2);var g=this.$events;if(g){var y=nn.call(arguments,1),b=[a].concat(y);if("all"===c)for(i in avalon.vmodels)v=avalon.vmodels[i],v!==this&&v.$fire.apply(v,b);else if("up"===c||"down"===c){var w=g.expr?Hn(g.expr):[];if(0===w.length)return;for(i in avalon.vmodels)if(v=avalon.vmodels[i],v!==this&&v.$events.expr){var $=Hn(v.$events.expr);if(0===$.length)continue;tn.forEach.call($,function(a){tn.forEach.call(w,function(h){var g="down"===c?h.contains(a):a.contains(h);g&&(a._avalon=v)})})}var C=Bt.getElementsByTagName("*"),k=[];for(tn.forEach.call(C,function(a){a._avalon&&(k.push(a._avalon),a._avalon="",a.removeAttribute("_avalon"))}),"up"===c&&k.reverse(),i=0;(h=k[i++])&&h.$fire.apply(h,b)!==!1;);}else{var T=g[a]||[],_=g.$all||[];for(i=0;h=T[i++];)fn(h)&&h.apply(this,y);for(i=0;h=_[i++];)fn(h)&&h.apply(this,arguments)}}}},Fn=avalon.vmodels={};avalon.define=function(a,c){var g=a.$id||a;if(g||v("warning: vm必须指定$id"),Fn[g]&&v("warning: "+g+" 已经存在于avalon.vmodels中"),"object"==typeof a)var y=M(a);else{var b={$watch:h};c(b),y=M(b),qt=!0,c(y),qt=!1}return y.$id=g,Fn[g]=y};var Bn=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$proxy,$reinitialize,$propertyNames").match(Gt),In=Object.defineProperty,Rn=!0;try{In({},"_",{value:"x"});var Vn=Object.defineProperties}catch(e){Rn=!1}var zn={value:function(a){return a in this.$model},writable:!1,enumerable:!1,configurable:!0},Wn=Object.is||function(a,c){return 0===a&&0===c?1/a===1/c:a!==a?c!==c:a===c},Xn=rn?function(a){var c={};for(var i in a)c[i]={get:a[i],set:a[i],enumerable:!0,configurable:!0};return c}:function(a){return a};if(!Rn&&("__defineGetter__"in avalon&&(In=function(a,c,v){return"value"in v&&(a[c]=v.value),"get"in v&&a.__defineGetter__(c,v.get),"set"in v&&a.__defineSetter__(c,v.set),a},Vn=function(a,c){for(var v in c)c.hasOwnProperty(v)&&In(a,v,c[v]);return a}),un)){var Yn={};a.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),Vn=function(c,v,h){var g=[];g.push("\r\n	Private [__data__], [__proxy__]","	Public Default Function [__const__](d, p)","		Set [__data__] = d: set [__proxy__] = p","		Set [__const__] = Me","	End Function");for(c in h)v.hasOwnProperty(c)||g.push("	Public ["+c+"]");Bn.forEach(function(a){v.hasOwnProperty(a)||g.push("	Public ["+a+"]")}),g.push("	Public [hasOwnProperty]");for(c in v)g.push("	Public Property Let ["+c+"](val"+Ft+")",'		Call [__proxy__](Me,[__data__], "'+c+'", val'+Ft+")","	End Property","	Public Property Set ["+c+"](val"+Ft+")",'		Call [__proxy__](Me,[__data__], "'+c+'", val'+Ft+")","	End Property","	Public Property Get ["+c+"]","	On Error Resume Next","		Set["+c+'] = [__proxy__](Me,[__data__],"'+c+'")',"	If Err.Number <> 0 Then","		["+c+'] = [__proxy__](Me,[__data__],"'+c+'")',"	End If","	On Error Goto 0","	End Property");g.push("End Class");var y=g.join("\r\n"),b=Yn[y];b||(b=cn("VBClass"),a.parseVB("Class "+b+y),a.parseVB(["Function "+b+"Factory(a, b)","	Dim o","	Set o = (New "+b+")(a, b)","	Set "+b+"Factory = o","End Function"].join("\r\n")),Yn[y]=b);var w=a[b+"Factory"](v,F);return w}}var qn=tn.splice,Gn={_splice:qn,_fire:function(a,c,v){z(this.$events[Wt],a,c,v)},size:function(){return this._.length},pushArray:function(a){var m=a.length,n=this.length;return m&&(tn.push.apply(this.$model,a),I.call(this,"add",n,m,Math.max(0,n-1))),m+n},push:function(){var i,a=[],n=arguments.length;for(i=0;n>i;i++)a[i]=arguments[i];return this.pushArray(a)},unshift:function(){var m=arguments.length,n=this.length;return m&&(tn.unshift.apply(this.$model,arguments),I.call(this,"add",0,m,0)),m+n},shift:function(){if(this.length){var a=this.$model.shift();return I.call(this,"del",0,1,0),a}},pop:function(){var n=this.length;if(n){var a=this.$model.pop();return I.call(this,"del",n-1,1,Math.max(0,n-2)),a}},splice:function(a){var c,m=arguments.length,v=[],h=qn.apply(this.$model,arguments);return h.length&&(v.push("del",a,h.length,0),c=!0),m>2&&(c?v.splice(3,1,0,"add",a,m-2):v.push("add",a,m-2,0),c=!0),c?I.apply(this,v):[]},contains:function(a){return-1!==this.indexOf(a)},remove:function(a){return this.removeAt(this.indexOf(a))},removeAt:function(a){return a>=0?(this.$model.splice(a,1),I.call(this,"del",a,1,0)):[]},clear:function(){return this.$model.length=this.length=this._.length=0,this._fire("clear",0),this},removeAll:function(a){if(Array.isArray(a))for(var i=this.length-1;i>=0;i--)-1!==a.indexOf(this[i])&&this.removeAt(i);else if("function"==typeof a)for(i=this.length-1;i>=0;i--){var c=this[i];a(c,i)&&this.removeAt(i)}else this.clear()},ensure:function(a){return this.contains(a)||this.push(a),this
},set:function(a,c){if(a>=0){var v=avalon.type(c);c&&c.$model&&(c=c.$model);var h=this[a];if("object"===v)for(var i in c)h.hasOwnProperty(i)&&(h[i]=c[i]);else"array"===v?h.clear().push.apply(h,c):h!==c&&(this[a]=c,this.$model[a]=c,this._fire("set",a,c))}return this}};"sort,reverse".replace(Gt,function(a){Gn[a]=function(){var c,v=this.$model,h=v.concat(),g=Math.random(),y=[];tn[a].apply(v,arguments);for(var i=0,n=h.length;n>i;i++){var b=v[i],w=h[i];if(Wn(b,w))y.push(i);else{var $=h.indexOf(b);y.push($),h[$]=g,c=!0}}return c&&(R(this,y),this._fire("move",y),this._fire("index",0)),this}});var Un=function(){var a,c=[];return{begin:function(v){c.push(a),a=v},end:function(){a=c.pop()},collectDependency:function(c,v){a&&a.callback(c,v)}}}(),Jn=/^(duplex|on)$/;avalon.injectBinding=function(a){var c=a.evaluator;if(c){Un.begin({callback:function(c,v){V(c.$events[v._name],a)}});try{var v=Jn.test(a.type)?a:c.apply(0,a.args);a.handler(v,a.element,a)}catch(e){delete a.evaluator;var h=a.element;if(3===h.nodeType){var g=h.parentNode;A.commentInterpolate?g.replaceChild(Bt.createComment(a.value),h):h.data=An+(a.oneTime?"::":"")+a.value+On}}finally{Un.end()}}};var Zn=0,Kn=avalon.$$subscribers=[],Qn=new Date,er={},tr={},nr={area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],col:[2,"<table><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table>","</table>"],td:[3,"<table><tr>","</tr></table>"],g:[1,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',"</svg>"],_default:rn?[0,"",""]:[1,"X<div>","</div>"]};nr.th=nr.td,nr.optgroup=nr.option,nr.tbody=nr.tfoot=nr.colgroup=nr.caption=nr.thead,String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(Gt,function(a){nr[a]=nr.g});var rr=/<([\w:]+)/,ar=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,lr=rn?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/gi,sr=g(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),cr=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,ur=Bt.createElement("script"),fr=/<|&#?\w+;/;avalon.parseHTML=function(a){var c=on.cloneNode(!1);if("string"!=typeof a)return c;if(!fr.test(a))return c.appendChild(Bt.createTextNode(a)),c;a=a.replace(ar,"<$1></$2>").trim();var v,h,g=(rr.exec(a)||["",""])[1].toLowerCase(),y=nr[g]||nr._default,b=ln;rn||(a=a.replace(lr,"<br class=msNoScope>$1")),b.innerHTML=y[1]+a+y[2];var w=b.getElementsByTagName("script");if(w.length)for(var $,i=0;$=w[i++];)sr[$.type]&&(h=ur.cloneNode(!1),tn.forEach.call($.attributes,function(a){a&&a.specified&&(h[a.name]=a.value,h.setAttribute(a.name,a.value))}),h.text=$.text,$.parentNode.replaceChild(h,$));if(!rn){var C="X<div>"===y[1]?b.lastChild.firstChild:b.lastChild;if(C&&"TABLE"===C.tagName&&"tbody"!==g)for(w=C.childNodes,i=0;$=w[i++];)if("TBODY"===$.tagName&&!$.innerHTML){C.removeChild($);break}w=b.getElementsByTagName("br");for(var n=w.length;$=w[--n];)"msNoScope"===$.className&&$.parentNode.removeChild($);for(w=b.all,i=0;$=w[i++];)J($)&&Z($)}for(i=y[0];i--;b=b.lastChild);for(;v=b.firstChild;)c.appendChild(v);return c},avalon.innerHTML=function(a,c){if(!rn&&!lr.test(c)&&!cr.test(c))try{return void(a.innerHTML=c)}catch(e){}var v=this.parseHTML(c);this.clearHTML(a).appendChild(v)},avalon.clearHTML=function(a){for(a.textContent="";a.firstChild;)a.removeChild(a.firstChild);return a};var pr={_toString:function(){var a=this.node,c=a.className,v="string"==typeof c?c:c.baseVal;return v.split(/\s+/).join(" ")},_contains:function(a){return(" "+this+" ").indexOf(" "+a+" ")>-1},_add:function(a){this.contains(a)||this._set(this+" "+a)},_remove:function(a){this._set((" "+this+" ").replace(" "+a+" "," "))},__set:function(a){a=a.trim();var c=this.node;Jt.test(c)?c.setAttribute("class",a):c.className=a}};"add,remove".replace(Gt,function(a){avalon.fn[a+"Class"]=function(c){var v=this[0];return c&&"string"==typeof c&&v&&1===v.nodeType&&c.replace(/\S+/g,function(c){et(v)[a](c)}),this}}),avalon.fn.mix({hasClass:function(a){var c=this[0]||{};return 1===c.nodeType&&et(c).contains(a)},toggleClass:function(a,c){for(var v,i=0,h=String(a).split(/\s+/),g="boolean"==typeof c;v=h[i++];){var y=g?c:!this.hasClass(v);this[y?"addClass":"removeClass"](v)}return this},attr:function(a,c){return 2===arguments.length?(this[0].setAttribute(a,c),this):this[0].getAttribute(a)},data:function(a,c){switch(a="data-"+K(a||""),arguments.length){case 2:return this.attr(a,c),this;case 1:var v=this.attr(a);return tt(v);case 0:var h={};return tn.forEach.call(this[0].attributes,function(c){c&&(a=c.name,a.indexOf("data-")||(a=Q(a.slice(5)),h[a]=tt(c.value)))}),h}},removeData:function(a){return a="data-"+K(a),this[0].removeAttribute(a),this},css:function(a,c){if(avalon.isPlainObject(a))for(var i in a)avalon.css(this,i,a[i]);else var v=avalon.css(this,a,c);return void 0!==v?v:this},position:function(){var a,c,v=this[0],h={top:0,left:0};if(v)return"fixed"===this.css("position")?c=v.getBoundingClientRect():(a=this.offsetParent(),c=this.offset(),"HTML"!==a[0].tagName&&(h=a.offset()),h.top+=avalon.css(a[0],"borderTopWidth",!0),h.left+=avalon.css(a[0],"borderLeftWidth",!0),h.top-=a.scrollTop(),h.left-=a.scrollLeft()),{top:c.top-h.top-avalon.css(v,"marginTop",!0),left:c.left-h.left-avalon.css(v,"marginLeft",!0)}},offsetParent:function(){for(var a=this[0].offsetParent;a&&"static"===avalon.css(a,"position");)a=a.offsetParent;return avalon(a||an)},bind:function(a,c,v){return this[0]?avalon.bind(this[0],a,c,v):void 0},unbind:function(a,c,v){return this[0]&&avalon.unbind(this[0],a,c,v),this},val:function(a){var c=this[0];if(c&&1===c.nodeType){var v=0===arguments.length,h=v?":get":":set",g=Mr[it(c)+h];if(g)var y=g(c,a);else{if(v)return(c.value||"").replace(/\r/g,"");c.value=a}}return v?y:this}});var dr=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,vr=/^[\],:{}\s]*$/,hr=/(?:^|:|,)(?:\s*\[)+/g,mr=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,gr=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;avalon.parseJSON=a.JSON?JSON.parse:function(a){if("string"==typeof a){if(a=a.trim(),a&&vr.test(a.replace(mr,"@").replace(gr,"]").replace(hr,"")))return new Function("return "+a)();avalon.error("Invalid JSON: "+a)}return a},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){avalon.fn[a]=function(v){var h=this[0]||{},g=nt(h),y="scrollTop"===a;return arguments.length?void(g?g.scrollTo(y?avalon(g).scrollLeft():v,y?v:avalon(g).scrollTop()):h[a]=v):g?c in g?g[c]:an[a]:h[a]}});var yr=avalon.cssHooks={},br=["","-webkit-","-o-","-moz-","-ms-"],xr={"float":rn?"cssFloat":"styleFloat"};if(avalon.cssNumber=g("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(a,c,v){if(xr[a])return xr[a];c=c||an.style;for(var i=0,n=br.length;n>i;i++)if(v=Q(br[i]+a),v in c)return xr[a]=v;return null},yr["@:set"]=function(a,c,v){try{a.style[c]=v}catch(e){}},a.getComputedStyle)yr["@:get"]=function(a,c){if(!a||!a.style)throw new Error("getComputedStyle要求传入一个节点 "+a);var v,h=getComputedStyle(a,null);return h&&(v="filter"===c?h.getPropertyValue(c):h[c],""===v&&(v=a.style[c])),v},yr["opacity:get"]=function(a){var c=yr["@:get"](a,"opacity");return""===c?"1":c};else{var wr=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,$r=/^(top|right|bottom|left)$/,Cr=/alpha\([^)]*\)/i,kr=!!a.XDomainRequest,Tr="DXImageTransform.Microsoft.Alpha",_r={thin:kr?"1px":"2px",medium:kr?"3px":"4px",thick:kr?"5px":"6px"};yr["@:get"]=function(a,c){var v=a.currentStyle,h=v[c];if(wr.test(h)&&!$r.test(h)){var g=a.style,y=g.left,b=a.runtimeStyle.left;a.runtimeStyle.left=v.left,g.left="fontSize"===c?"1em":h||0,h=g.pixelLeft+"px",g.left=y,a.runtimeStyle.left=b}return"medium"===h&&(c=c.replace("Width","Style"),"none"===v[c]&&(h="0px")),""===h?"auto":_r[h]||h},yr["opacity:set"]=function(a,c,v){var h=a.style,g=isFinite(v)&&1>=v?"alpha(opacity="+100*v+")":"",y=h.filter||"";h.zoom=1,h.filter=(Cr.test(y)?y.replace(Cr,g):y+" "+g).trim(),h.filter||h.removeAttribute("filter")},yr["opacity:get"]=function(a){var c=a.filters.alpha||a.filters[Tr],v=c&&c.enabled?c.opacity:100;return v/100+""}}"top,left".replace(Gt,function(a){yr[a+":get"]=function(c){var v=yr["@:get"](c,a);return/px$/.test(v)?v:avalon(c).position()[a]+"px"}});var Er={position:"absolute",visibility:"hidden",display:"block"},Ar=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(Gt,function(a){var c=a.toLowerCase(),v="client"+a,h="scroll"+a,g="offset"+a;yr[c+":get"]=function(c,v,h){var y=-4;"number"==typeof h&&(y=h),v="Width"===a?["Left","Right"]:["Top","Bottom"];var b=c[g];return 2===y?b+avalon.css(c,"margin"+v[0],!0)+avalon.css(c,"margin"+v[1],!0):(0>y&&(b=b-avalon.css(c,"border"+v[0]+"Width",!0)-avalon.css(c,"border"+v[1]+"Width",!0)),-4===y&&(b=b-avalon.css(c,"padding"+v[0],!0)-avalon.css(c,"padding"+v[1],!0)),b)},yr[c+"&get"]=function(a){var v=[];at(a,v);for(var h,g=yr[c+":get"](a),i=0;h=v[i++];){a=h.node;for(var n in h)"string"==typeof h[n]&&(a.style[n]=h[n])}return g},avalon.fn[c]=function(y){var b=this[0];if(0===arguments.length){if(b.setTimeout)return b["inner"+a]||b.document.documentElement[v];if(9===b.nodeType){var w=b.documentElement;return Math.max(b.body[h],w[h],b.body[g],w[g],w[v])}return yr[c+"&get"](b)}return this.css(c,y)},avalon.fn["inner"+a]=function(){return yr[c+":get"](this[0],void 0,-2)},avalon.fn["outer"+a]=function(a){return yr[c+":get"](this[0],void 0,a===!0?2:0)}}),avalon.fn.offset=function(){var a=this[0],c={left:0,top:0};if(!a||!a.tagName||!a.ownerDocument)return c;var v=a.ownerDocument,h=v.body,g=v.documentElement,y=v.defaultView||v.parentWindow;if(!avalon.contains(g,a))return c;a.getBoundingClientRect&&(c=a.getBoundingClientRect());var b=g.clientTop||h.clientTop,w=g.clientLeft||h.clientLeft,$=Math.max(y.pageYOffset||0,g.scrollTop,h.scrollTop),C=Math.max(y.pageXOffset||0,g.scrollLeft,h.scrollLeft);return{top:c.top+$-b,left:c.left+C-w}};var Or=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,Mr={"option:get":un?function(a){return Or.test(a.outerHTML)?a.value:a.text.trim()}:function(a){return a.value},"select:get":function(a,c){for(var v,h=a.options,g=a.selectedIndex,y=Mr["option:get"],b="select-one"===a.type||0>g,w=b?null:[],$=b?g+1:h.length,i=0>g?$:b?g:0;$>i;i++)if(v=h[i],(v.selected||i===g)&&!v.disabled){if(c=y(v),b)return c;w.push(c)}return w},"select:set":function(a,c,v){c=[].concat(c);for(var h,g=Mr["option:get"],i=0;h=a.options[i++];)(h.selected=c.indexOf(g(h))>-1)&&(v=!0);v||(a.selectedIndex=-1)}},Nr={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},Sr=a.JSON&&JSON.stringify||function(a){return'"'+a.replace(/[\\\"\x00-\x1f]/g,function(a){var c=Nr[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},jr=["break,case,catch,continue,debugger,default,delete,do,else,false","finally,for,function,if,in,instanceof,new,null,return,switch,this","throw,true,try,typeof,var,void,while,with","abstract,boolean,byte,char,class,const,double,enum,export,extends","final,float,goto,implements,import,int,interface,long,native","package,private,protected,public,short,static,super,synchronized","throws,transient,volatile","arguments,let,yield,undefined"].join(","),Lr=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,Dr=/[^\w$]+/g,Hr=new RegExp(["\\b"+jr.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),Pr=/\b\d[^,]*/g,Fr=/^,+|,+$/g,Br=new mn(512),Ir=function(a){var c=","+a.trim(),v=Br.get(c);if(v)return v;var h=a.replace(Lr,"").replace(Dr,",").replace(Hr,"").replace(Pr,"").replace(Fr,"").split(/^$|,+/);return Br.put(c,lt(h))},Rr=new mn(128),Vr=/\w\[.*\]|\w\.\w/,zr=/(\$proxy\$[a-z]+)\d+$/,Wr=/\)\s*$/,Xr=/\)\s*\|/g,Yr=/\|\s*([$\w]+)/g,qr=/"\s*\["/g,Gr=/"\s*\(/g;avalon.parseExprProxy=ut,avalon.scan=function(a,c){a=a||an;var v=c?[].concat(c):[];yt(a,v)};var Ur=g("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase()),Jr=function(a,c,v){var h=a.getAttribute(c);if(h)for(var g,i=0;g=v[i++];)if(g.hasOwnProperty(h)&&"function"==typeof g[h])return g[h]},Zr=un&&a.MutationObserver?function(a){for(var c,v=a.firstChild;v;){var h=v.nextSibling;3===v.nodeType?c?(c.nodeValue+=v.nodeValue,a.removeChild(v)):c=v:c=null,v=h}}:0,Kr=/^\s*::/,Qr=/ms-(\w+)-?(.*)/,ea={"if":10,repeat:90,data:100,widget:110,each:1400,"with":1500,duplex:2e3,on:3e3},ta=g("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),na=g("value,title,alt,checked,selected,disabled,readonly,enabled"),ra=/^if|widget|repeat$/,aa=/^each|with|html|include$/;if(!"1"[0])var ia=new mn(512),oa=/\s+(ms-[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,la=/^['"]/,sa=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/i,ca=/&amp;/g,ua=function(a){var c=a.outerHTML;if("</"===c.slice(0,2)||!c.trim())return[];var v,h,g,y=c.match(sa)[0],b=[],w=ia.get(y);if(w)return w;for(;h=oa.exec(y);){g=h[2],g&&(g=(la.test(g)?g.slice(1,-1):g).replace(ca,"&"));var $=h[1].toLowerCase();v=$.match(Qr);var C={name:$,specified:!0,value:g||""};b.push(C)}return ia.put(y,b)};var fa=/\|\s*html\s*/,pa=/\|\|/g,da=/&lt;/g,va=/&gt;/g,ha=/(['"])(\\\1|.)+?\1/g,ma=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected","contentEditable,isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(","),ga={};ma.replace(Gt,function(a){ga[a.toLowerCase()]=a});var ya={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},ba=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight","rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");ba.replace(Gt,function(a){ya[a.toLowerCase()]=a});var xa=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/gim,wa=/<noscript.*?>([\s\S]+?)<\/noscript>/im,$a=function(){return new(a.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},Ca=avalon.templateCache={};vn.attr=function(a,c){var v=a.value.trim(),h=!0;if(v.indexOf(An)>-1&&v.indexOf(On)>2&&(h=!1,Mn.test(v)&&""===RegExp.rightContext&&""===RegExp.leftContext&&(h=!0,v=RegExp.$1)),"include"===a.type){var g=a.element;a.includeRendered=Jr(g,"data-include-rendered",c),a.includeLoaded=Jr(g,"data-include-loaded",c);var y=a.includeReplace=!!avalon(g).data("includeReplace");avalon(g).data("includeCache")&&(a.templateCache={}),a.startInclude=Bt.createComment("ms-include"),a.endInclude=Bt.createComment("ms-include-end"),y?(a.element=a.startInclude,g.parentNode.insertBefore(a.startInclude,g),g.parentNode.insertBefore(a.endInclude,g.nextSibling)):(g.insertBefore(a.startInclude,g.firstChild),g.appendChild(a.endInclude))}a.handlerName="attr",ut(v,c,a,h?0:xt(a.value))},hn.attr=function(c,v,h){var g=h.type,y=h.param;if("css"===g)avalon(v).css(y,c);else if("attr"===g){var b=c===!1||null===c||void 0===c;!rn&&ya[y]&&(y=ya[y]);var w=ga[y];if("boolean"==typeof v[w]&&(v[w]=!!c,c||(b=!0)),b)return v.removeAttribute(y);var $=Jt.test(v)?!1:Bt.namespaces&&J(v)?!0:y in v.cloneNode(!1);$?v[y]=c+"":v.setAttribute(y,c)}else if("include"===g&&c){var C=h.vmodels,k=h.includeRendered,T=h.includeLoaded,_=h.includeReplace,E=_?v.parentNode:v,A=function(a){if(T){var v=T.apply(E,[a].concat(C));"string"==typeof v&&(a=v)}k&&ft(E,function(){k.call(E)},0/0);var g=h.includeLastID;if(h.templateCache&&g&&g!==c){var y=h.templateCache[g];y||(y=h.templateCache[g]=Bt.createElement("div"),Rt.appendChild(y))}for(h.includeLastID=c;;){var b=h.startInclude.nextSibling;if(!b||b===h.endInclude)break;E.removeChild(b),y&&y.appendChild(b)}var w=$t(h,c,a),$=avalon.slice(w.childNodes);E.insertBefore(w,h.endInclude),gt($,C)};if("src"===h.param)if("string"==typeof Ca[c])avalon.nextTick(function(){A(Ca[c])});else if(Array.isArray(Ca[c]))Ca[c].push(A);else{var O=$a();O.onreadystatechange=function(){if(4===O.readyState){var s=O.status;if(s>=200&&300>s||304===s||1223===s){for(var a,v=O.responseText,f=0;a=Ca[c][f++];)a(v);Ca[c]=v}}},Ca[c]=[A],O.open("GET",c,!0),"withCredentials"in O&&(O.withCredentials=!0),O.setRequestHeader("X-Requested-With","XMLHttpRequest"),O.send(null)}else{var M=c&&1===c.nodeType?c:Bt.getElementById(c);if(M){if("NOSCRIPT"===M.tagName&&!M.innerHTML&&!M.fixIE78){O=$a(),O.open("GET",location,!1),O.send(null);for(var N=Bt.getElementsByTagName("noscript"),S=(O.responseText||"").match(xa)||[],n=S.length,i=0;n>i;i++){var j=N[i];j&&(j.style.display="none",j.fixIE78=(S[i].match(wa)||["","&nbsp;"])[1])}}avalon.nextTick(function(){A(M.fixIE78||M.value||M.innerText||M.innerHTML)})}}}else if(an.hasAttribute||"string"!=typeof c||"src"!==g&&"href"!==g||(c=c.replace(/&amp;/g,"&")),v[g]=c,a.chrome&&"EMBED"===v.tagName){var L=v.parentNode,D=document.createComment("ms-src");L.replaceChild(D,v),L.replaceChild(v,D)}},"title,alt,src,value,css,include,href".replace(Gt,function(a){vn[a]=vn.attr}),vn["class"]=function(a,c){var h,g=a.param,y=a.value;if(a.handlerName="class",!g||isFinite(g)){a.param="";var b=y.replace(Nn,function(a){return a.replace(/./g,"0")}),w=b.indexOf(":");if(-1===w)var $=y;else{if($=y.slice(0,w),h=y.slice(w+1),ct(h,c,a),!a.evaluator)return v("debug: ms-class '"+(h||"").trim()+"' 不存在于VM中"),!1;a._evaluator=a.evaluator,a._args=a.args}var C=Mn.test($);C||(a.immobileClass=$),ut("",c,a,C?xt($):0)}else a.immobileClass=a.oldStyle=a.param,ut(y,c,a)},hn["class"]=function(a,c,v){var h=avalon(c),g=v.type;if("class"===g&&v.oldStyle)h.toggleClass(v.oldStyle,!!a);else switch(v.toggleClass=v._evaluator?!!v._evaluator.apply(c,v._args):!0,v.newClass=v.immobileClass||a,v.oldClass&&v.newClass!==v.oldClass&&h.removeClass(v.oldClass),v.oldClass=v.newClass,g){case"class":h.toggleClass(v.newClass,v.toggleClass);break;case"hover":case"active":if(!v.hasBindEvent){var y="mouseenter",b="mouseleave";if("active"===g){c.tabIndex=c.tabIndex||-1,y="mousedown",b="mouseup";var w=h.bind("mouseleave",function(){v.toggleClass&&h.removeClass(v.newClass)})}var $=h.bind(y,function(){v.toggleClass&&h.addClass(v.newClass)}),C=h.bind(b,function(){v.toggleClass&&h.removeClass(v.newClass)});v.rollback=function(){h.unbind("mouseleave",w),h.unbind(y,$),h.unbind(b,C)},v.hasBindEvent=!0}}},"hover,active".replace(Gt,function(a){vn[a]=vn["class"]}),hn.data=function(a,c,v){var h="data-"+v.param;a&&"object"==typeof a?c[h]=a:c.setAttribute(h,String(a))};var ka=vn.duplex=function(a,c){var y,b=a.element;if(ut(a.value,c,a,0,1),a.changed=Jr(b,"data-duplex-changed",c)||h,a.evaluator&&a.args){var w=[],$=g("string,number,boolean,checked");"radio"===b.type&&""===a.param&&(a.param="checked"),b.msData&&(b.msData["ms-duplex"]=a.value),a.param.replace(/\w+/g,function(c){/^(checkbox|radio)$/.test(b.type)&&/^(radio|checked)$/.test(c)&&("radio"===c&&v("ms-duplex-radio已经更名为ms-duplex-checked"),c="checked",a.isChecked=!0),"bool"===c?(c="boolean",v("ms-duplex-bool已经更名为ms-duplex-boolean")):"text"===c&&(c="string",v("ms-duplex-text已经更名为ms-duplex-string")),$[c]&&(y=!0),avalon.Array.ensure(w,c)}),y||w.push("string"),a.param=w.join("-"),a.bound=function(c,v){b.addEventListener?b.addEventListener(c,v,!1):b.attachEvent("on"+c,v);var h=a.rollback;a.rollback=function(){b.avalonSetter=null,avalon.unbind(b,c,v),h&&h()}};for(var i in avalon.vmodels){var C=avalon.vmodels[i];C.$fire("avalon-ms-duplex-init",a)}var k=a.pipe||(a.pipe=kt);k(null,a,"init");var T=b.tagName;ka[T]&&ka[T](b,a.evaluator.apply(null,a.args),a)}};avalon.duplexHooks={checked:{get:function(a,c){return!c.element.oldValue}},string:{get:function(a){return a},set:Ct},"boolean":{get:function(a){return"true"===a},set:Ct},number:{get:function(a,c){var v=parseFloat(a);if(-a===-v)return v;var h=/strong|medium|weak/.exec(c.element.getAttribute("data-duplex-number"))||["medium"];switch(h[0]){case"strong":return 0;case"medium":return""===a?"":0;case"weak":return a}},set:Ct}};var Ta,_a=[];avalon.tick=function(a){1===_a.push(a)&&(Ta=setInterval(Tt,60))};var Ea=h,Aa=/text|password|hidden/;!new function(){function a(a){c[this.tagName].call(this,a),Aa.test(this.type)&&!this.msFocus&&this.avalonSetter&&this.avalonSetter()}try{var c={},v=HTMLInputElement.prototype,h=HTMLTextAreaElement.prototype,g=HTMLInputElement.prototype;Object.getOwnPropertyNames(g),c.INPUT=Object.getOwnPropertyDescriptor(v,"value").set,Object.defineProperty(v,"value",{set:a}),c.TEXTAREA=Object.getOwnPropertyDescriptor(h,"value").set,Object.defineProperty(h,"value",{set:a})}catch(e){Ea=avalon.tick}},un&&avalon.bind(Bt,"selectionchange",function(){var a=Bt.activeElement;a&&"function"==typeof a.avalonSetter&&a.avalonSetter()}),ka.INPUT=function(a,c,h){function g(a){h.changed.call(this,a,h)}function y(){T=!0}function b(){T=!1}function w(e){setTimeout(function(){_(e)})}var $=a.type,C=h.bound,k=avalon(a),T=!1,_=function(){if(!T){var v=a.oldValue=a.value,y=h.pipe(v,h,"get");k.data("duplexObserve")!==!1&&(c(y),g.call(a,y),k.data("duplex-focus")&&avalon.nextTick(function(){a.focus()}))}};if(h.handler=function(){var v=h.pipe(c(),h,"set")+"";v!==a.oldValue&&(a.value=v)},h.isChecked||"radio"===$){var E=6===un;_=function(){if(k.data("duplexObserve")!==!1){var v=h.pipe(a.value,h,"get");c(v),g.call(a,v)}},h.handler=function(){var v=c(),g=h.isChecked?!!v:v+""===a.value;a.oldValue=g,E?setTimeout(function(){a.defaultChecked=g,a.checked=g},31):a.checked=g},C("click",_)}else if("checkbox"===$)_=function(){if(k.data("duplexObserve")!==!1){var y=a.checked?"ensure":"remove",b=c();Array.isArray(b)||(v("ms-duplex应用于checkbox上要对应一个数组"),b=[b]);var w=h.pipe(a.value,h,"get");avalon.Array[y](b,w),g.call(a,b)}},h.handler=function(){var v=[].concat(c()),g=h.pipe(a.value,h,"get");a.checked=v.indexOf(g)>-1},C(rn?"change":"click",_);else{var A=a.getAttribute("data-duplex-event")||"input";a.attributes["data-event"]&&v("data-event指令已经废弃，请改用data-duplex-event"),A.replace(Gt,function(a){switch(a){case"input":un?(un>8?C("input",_):C("propertychange",function(e){"value"===e.propertyName&&_()}),C("dragend",w)):(C("input",_),C("compositionstart",y),C("compositionend",b),C("DOMAutoComplete",_));break;default:C(a,_)}}),C("focus",function(){a.msFocus=!0}),C("blur",function(){a.msFocus=!1}),Aa.test($)&&Ea(function(){if(an.contains(a))a.msFocus||a.oldValue===a.value||_();else if(!a.msRetain)return!1}),a.avalonSetter=_}a.oldValue=a.value,avalon.injectBinding(h),g.call(a,a.value)},ka.TEXTAREA=ka.INPUT,ka.SELECT=function(a,c,h){function g(){if(y.data("duplexObserve")!==!1){var v=y.val();v=Array.isArray(v)?v.map(function(a){return h.pipe(a,h,"get")}):h.pipe(v,h,"get"),v+""!==a.oldValue&&c(v),h.changed.call(a,v,h)}}var y=avalon(a);h.handler=function(){var h=c();h=h&&h.$model||h,Array.isArray(h)?a.multiple||v("ms-duplex在<select multiple=true>上要求对应一个数组"):a.multiple&&v("ms-duplex在<select multiple=false>不能对应一个数组"),h=Array.isArray(h)?h.map(String):h+"",h+""!==a.oldValue&&(y.val(h),a.oldValue=h+"")},h.bound("change",g),a.msCallback=function(){avalon.injectBinding(h),h.changed.call(a,c(),h)}},hn.html=function(a,c,v){var h=1!==c.nodeType,g=h?c.parentNode:c;if(g&&(a=null==a?"":a,v.oldText!==a)){if(v.oldText=a,3===c.nodeType){var y=cn("html");g.insertBefore(Bt.createComment(y),c),v.element=Bt.createComment(y+":end"),g.replaceChild(v.element,c),c=v.element}if("object"!=typeof a)var b=avalon.parseHTML(String(a));else if(11===a.nodeType)b=a;else if(1===a.nodeType||a.item){var w=1===a.nodeType?a.childNodes:a.item;for(b=on.cloneNode(!0);w[0];)b.appendChild(w[0])}if(w=avalon.slice(b.childNodes),h){for(var $=c.nodeValue.slice(0,-4);;){var C=c.previousSibling;if(!C||8===C.nodeType&&C.nodeValue===$)break;g.removeChild(C)}g.insertBefore(b,c)}else avalon.clearHTML(c).appendChild(b);gt(w,v.vmodels)}},vn["if"]=vn.data=vn.text=vn.html=function(a,c){ut(a.value,c,a)},hn["if"]=function(a,c,v){try{if(!c.parentNode)return}catch(e){return}if(a)8===c.nodeType&&(c.parentNode.replaceChild(v.template,c),c=v.element=v.template),c.getAttribute(v.name)&&(c.removeAttribute(v.name),ht(c,v.vmodels)),v.rollback=null;else if(1===c.nodeType){var h=v.element=Bt.createComment("ms-if");c.parentNode.replaceChild(h,c),v.template=c,Rt.appendChild(c),v.rollback=function(){c.parentNode===Rt&&Rt.removeChild(c)}}};var Oa=/\(([^)]*)\)/;vn.on=function(a,c){var v=a.value;a.type="on";var h=a.param.replace(/-\d+$/,"");if("function"==typeof vn.on[h+"Hook"]&&vn.on[h+"Hook"](a),v.indexOf("(")>0&&v.indexOf(")")>-1){var g=(v.match(Oa)||["",""])[1].trim();(""===g||"$event"===g)&&(v=v.replace(Oa,""))}ut(v,c,a)},hn.on=function(a,c,v){a=function(e){var a=v.evaluator||h;return a.apply(this,v.args.concat(e))};var g=v.param.replace(/-\d+$/,"");if("scan"===g)a.call(c,{type:g});else if("function"==typeof v.specialBind)v.specialBind(c,a);else var y=avalon.bind(c,g,a);v.rollback=function(){"function"==typeof v.specialUnbind?v.specialUnbind():avalon.unbind(c,g,y)}},vn.repeat=function(a,c){var v=a.type;ut(a.value,c,a,0,1),a.proxies=[];var h=!1;try{var g=a.$repeat=a.evaluator.apply(0,a.args||[]),y=avalon.type(g);"object"!==y&&"array"!==y&&(h=!0,avalon.log("warning:"+a.value+"只能是对象或数组"))}catch(e){h=!0}var b=a.value.split(".")||[];if(b.length>1){b.pop();for(var w,n=b[0],i=0;w=c[i++];)if(w&&w.hasOwnProperty(n)){var $=w[n].$events||{};$[Wt]=$[Wt]||[],$[Wt].push(a);break}}var C=a.element;if(1===C.nodeType){C.removeAttribute(a.name),a.sortedCallback=Jr(C,"data-with-sorted",c),a.renderedCallback=Jr(C,"data-"+v+"-rendered",c);var k=cn(v),T=Bt.createComment(k),_=Bt.createComment(k+":end");if(a.signature=k,a.template=on.cloneNode(!1),"repeat"===v){var E=C.parentNode;E.replaceChild(_,C),E.insertBefore(T,_),a.template.appendChild(C)}else{for(;C.firstChild;)a.template.appendChild(C.firstChild);C.appendChild(T),C.appendChild(_)}a.element=_,a.handler=hn.repeat,a.rollback=function(){var c=a.element;c&&a.handler("clear")}}if(!h){a.$outer={};var A="$key",O="$val";for(Array.isArray(g)&&(A="$first",O="$last"),i=0;w=c[i++];)if(w.hasOwnProperty(A)&&w.hasOwnProperty(O)){a.$outer=w;break}var M=g.$events,N=(M||{})[Wt];V(N,a),"object"===y?(a.$with=!0,g.$proxy||(g.$proxy={}),a.handler("append",g)):g.length&&a.handler("add",0,g.length)}},hn.repeat=function(a,c,v){if(a){var g,y,b=this,w=b.element,$=Et(b),C=w.parentNode,k=b.proxies,T=on.cloneNode(!1);switch(a){case"add":for(var n=c+v,_=[],i=c;n>i;i++){var E=Lt(i,b);k.splice(i,0,E),_t(b,T,E,_)}var A=new Date-0;for(avalon.optimize=avalon.optimize||A,i=0;y=_[i++];)gt(y.nodes,y.vmodels),y.nodes=y.vmodels=null;avalon.optimize===A&&delete avalon.optimize,C.insertBefore(T,$[c]||w),avalon.profile("插入操作花费了 "+(new Date-A));break;case"del":At($[c],$[c+v]||w);var O=k.splice(c,v);Nt(O,"each");break;case"clear":g=$[0],g&&(At(g,w),b.$with&&C.insertBefore(g,w)),Nt(k,"each");break;case"move":if(g=$[0]){var M,N=g.nodeValue,S=[],j=[];for(At(g,w,function(){j.unshift(this),this.nodeValue===N&&(S.unshift(j),j=[])}),R(S,c),R(k,c);j=S.shift();)for(;M=j.shift();)T.appendChild(M);C.insertBefore(T,w)}break;case"index":for(var L=k.length-1;v=k[c];c++)v.$index=c,v.$first=0===c,v.$last=c===L;return;case"set":E=k[c],E&&z(E.$events[b.param||"el"]);break;case"append":var D=c,H=D.$proxy,P=[];_=[];for(var F in H)D.hasOwnProperty(F)||(Dt(H[F],Ma),delete H[F]);for(F in D)D.hasOwnProperty(F)&&"hasOwnProperty"!==F&&"$proxy"!==F&&P.push(F);if(b.sortedCallback){var B=b.sortedCallback.call(C,P);B&&Array.isArray(B)&&B.length&&(P=B)}for(i=0;F=P[i++];)"hasOwnProperty"!==F&&(H[F]=Mt(H[F],F,b),_t(b,T,H[F],_));for(C.insertBefore(T,w),i=0;y=_[i++];)gt(y.nodes,y.vmodels),y.nodes=y.vmodels=null}if(!b.$repeat||b.$repeat.hasOwnProperty("$lock"))return;"clear"===a&&(a="del");var I=b.renderedCallback||h,V=arguments;C.oldValue&&"SELECT"===C.tagName&&avalon(C).val(C.oldValue.split(",")),I.apply(C,V)}},"with,each".replace(Gt,function(a){vn[a]=vn.repeat});var Ma=[],Na=[];hn.text=function(a,c){if(a=null==a?"":a,3===c.nodeType)try{c.data=a}catch(e){}else"textContent"in c?c.textContent=a:c.innerText=a},avalon.parseDisplay=Ht,vn.visible=function(a,c){var v=avalon(a.element),h=v.css("display");if("none"===h){var g=v[0].style,y=/visibility/i.test(g.cssText),b=v.css("visibility");g.display="",g.visibility="hidden",h=v.css("display"),"none"===h&&(h=Ht(v[0].nodeName)),g.visibility=y?b:""}a.display=h,ut(a.value,c,a)},hn.visible=function(a,c,v){c.style.display=a?v.display:"none"},vn.widget=function(c,g){var y=c.value.match(Gt),b=c.element,w=y[0],$=y[1];$&&"$"!==$||($=cn(w));var C=y[2]||w,k=avalon.ui[w];if("function"==typeof k){g=b.vmodels||g;for(var T,i=0;T=g[i++];)if(T.hasOwnProperty(C)&&"object"==typeof T[C]){var _=T[C];_=_.$model||_;break}if(_){var E=_[w+"Id"];"string"==typeof E&&(v("warning!不再支持"+w+"Id"),$=E)}var A=avalon.getWidgetData(b,w);c.value=[w,$,C].join(","),c[w+"Id"]=$,c.evaluator=h,b.msData["ms-widget-id"]=$;var O=c[w+"Options"]=avalon.mix({},k.defaults,_||{},A);b.removeAttribute("ms-widget");var M=k(b,c,g)||{};if(M.$id){avalon.vmodels[$]=M,pt(b,M);try{M.$init(function(){avalon.scan(b,[M].concat(g)),"function"==typeof O.onInit&&O.onInit.call(b,M,O,g)})}catch(e){}c.rollback=function(){try{M.widgetElement=null,M.$remove()}catch(e){}b.msData={},delete avalon.vmodels[M.$id]},X(c,Sa),a.chrome&&b.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(Y)})}else avalon.scan(b,g)}else g.length&&(b.vmodels=g)};var Sa=[],ja=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,La=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,Da=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,Ha={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi},Pa=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Fa=/([^\#-~| |!])/g,Ba=avalon.filters={uppercase:function(a){return a.toUpperCase()},lowercase:function(a){return a.toLowerCase()},truncate:function(a,c,v){return c=c||30,v="string"==typeof v?v:"...",a.length>c?a.slice(0,c-v.length)+v:String(a)},$filter:function(a){for(var i=1,n=arguments.length;n>i;i++){var c=arguments[i],v=avalon.filters[c.shift()];if("function"==typeof v){var h=[a].concat(c);a=v.apply(null,h)}}return a},camelize:Q,sanitize:function(a){return a.replace(ja,"").replace(Da,function(a){var c=a.toLowerCase().match(/<(\w+)\s/);if(c){var v=Ha[c[1]];v&&(a=a.replace(v,function(s,a,c){var v=c.charAt(0);return a+"="+v+"javascript:void(0)"+v}))}return a.replace(La," ").replace(/\s+/g," ")})},escape:function(a){return String(a).replace(/&/g,"&amp;").replace(Pa,function(a){var c=a.charCodeAt(0),v=a.charCodeAt(1);return"&#"+(1024*(c-55296)+(v-56320)+65536)+";"}).replace(Fa,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(a,c,v){return(c||"￥")+Pt(a,isFinite(v)?v:2)},number:Pt};!new function(){function a(a){return parseInt(a,10)||0}function c(a,c,v){var h="";for(0>a&&(h="-",a=-a),a=""+a;a.length<c;)a="0"+a;return v&&(a=a.substr(a.length-c)),h+a}function v(a,v,h,g){return function(y){var b=y["get"+a]();return(h>0||b>-h)&&(b+=h),0===b&&-12===h&&(b=12),c(b,v,g)}}function h(a,c){return function(v,h){var g=v["get"+a](),y=(c?"SHORT"+a:a).toUpperCase();return h[y][g]}}function g(a){var v=-1*a.getTimezoneOffset(),h=v>=0?"+":"";return h+=c(Math[v>0?"floor":"ceil"](v/60),2)+c(Math.abs(v%60),2)}function y(a,c){return a.getHours()<12?c.AMPMS[0]:c.AMPMS[1]}var b={yyyy:v("FullYear",4),yy:v("FullYear",2,0,!0),y:v("FullYear",1),MMMM:h("Month"),MMM:h("Month",!0),MM:v("Month",2,1),M:v("Month",1,1),dd:v("Date",2),d:v("Date",1),HH:v("Hours",2),H:v("Hours",1),hh:v("Hours",2,-12),h:v("Hours",1,-12),mm:v("Minutes",2),m:v("Minutes",1),ss:v("Seconds",2),s:v("Seconds",1),sss:v("Milliseconds",3),EEEE:h("Day"),EEE:h("Day",!0),a:y,Z:g},w=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,$=/^\/Date\((\d+)\)\/$/;Ba.date=function(c,v){var h,g,y=Ba.date.locate,C="",k=[];if(v=v||"mediumDate",v=y[v]||v,"string"==typeof c)if(/^\d+$/.test(c))c=a(c);else if($.test(c))c=+RegExp.$1;else{var T=c.trim(),_=[0,0,0,0,0,0,0],E=new Date(0);
T=T.replace(/^(\d+)\D(\d+)\D(\d+)/,function(c,v,h,g){var y=4===g.length?[g,v,h]:[v,h,g];return _[0]=a(y[0]),_[1]=a(y[1])-1,_[2]=a(y[2]),""});var A=E.setFullYear,O=E.setHours;T=T.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(c,v,h,g,d){return _[3]=a(v),_[4]=a(h),_[5]=a(g),d&&(_[6]=Math.round(1e3*parseFloat("0."+d))),""});var M=0,N=0;T=T.replace(/Z|([+-])(\d\d):?(\d\d)/,function(c,v,h,d){return A=E.setUTCFullYear,O=E.setUTCHours,v&&(M=a(v+h),N=a(v+d)),""}),_[3]-=M,_[4]-=N,A.apply(E,_.slice(0,3)),O.apply(E,_.slice(3)),c=E}if("number"==typeof c&&(c=new Date(c)),"date"===avalon.type(c)){for(;v;)g=w.exec(v),g?(k=k.concat(g.slice(1)),v=k.pop()):(k.push(v),v=null);return k.forEach(function(a){h=b[a],C+=h?h(c,y):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),C}};var C={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};C.SHORTMONTH=C.MONTH,Ba.date.locate=C},new function(){function a(f){for(h=1;f=v.shift();)f()}avalon.config({loader:!1});var c,v=[],h="complete"===Bt.readyState;avalon.bind(Bt,"DOMContentLoaded",c=function(){avalon.unbind(Bt,"DOMContentLoaded",c),a()});var g=setInterval(function(){"complete"===document.readyState&&document.body&&(clearInterval(g),a())},50);avalon.ready=function(a){h?a(avalon):v.push(a)},avalon.ready(function(){avalon.scan(Bt.body)})},"function"==typeof define&&define.amd&&define("avalon",[],function(){return avalon});var Ia=a.avalon;return avalon.noConflict=function(c){return c&&a.avalon===avalon&&(a.avalon=Ia),avalon},void 0===c&&(a.avalon=avalon),avalon});
;/*!/dep/avalon/mmPromise/mmPromise.js*/
define("dep/avalon/mmPromise/mmPromise",["avalon"],function(c){function a(c){return c}function h(e){throw e}function v(c){return this.then(c,h)}function _(c){return this.then(a,c)}function y(){var c={};return c.promise=new this(function(a,h){c.resolve=a,c.reject=h}),c}function w(c,a){if("boolean"==typeof c.async)var h=c.async;else h=c.async=!0;h?window.setTimeout(a,0):a()}function b(c,a){if("pending"===c._state)if(a&&"function"==typeof a.then){var h=a instanceof k?"_then":"then";a[h](function(a){P(c,a,!0)},function(a){P(c,a,!1)})}else P(c,a,!0)}function g(c,a){"pending"===c._state&&P(c,a,!1)}function P(c,a,h){c._fired=!0,c._value=a,c._state=h?"fulfilled":"rejected",w(c,function(){c._callbacks.forEach(function(a){c._fire(a.onSuccess,a.onFail)})})}function j(c,a){a=Array.isArray(a)?a:[];var h,n=0,v=[];return new k(function(_,y){function w(w,b){w.then(function(y){h||(v[b]=y,n++,(c||n>=a.length)&&(_(c?y:v),h=!0))},function(e){h=!0,y(e)})}a.length||_(v);for(var i=0,l=a.length;l>i;i++)w(a[i],i)})}var k=function(c){this._callbacks=[];var a=this;if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof c)throw new TypeError("not a function");c(function(c){b(a,c)},function(c){g(a,c)})};k.resolve=function(c){return new k(function(a){a(c)})},k.reject=function(c){return new k(function(a,h){h(c)})},k.prototype={constructor:k,_state:"pending",_fired:!1,_fire:function(c,a){if("rejected"===this._state){if("function"!=typeof a)throw this._value;a(this._value)}else"function"==typeof c&&c(this._value)},_then:function(c,a){if(this._fired){var h=this;w(h,function(){h._fire(c,a)})}else this._callbacks.push({onSuccess:c,onFail:a})},then:function(c,v){c="function"==typeof c?c:a,v="function"==typeof v?v:h;var _=this,y=new k(function(a,h){_._then(function(v){try{v=c(v)}catch(e){return void h(e)}a(v)},function(c){try{c=v(c)}catch(e){return void h(e)}a(c)})});for(var i in _)E[i]||(y[i]=_[i]);return y},done:v,"catch":_,fail:_};var E={_state:1,_fired:1,_value:1,_callbacks:1};k.all=function(c){return j(!1,c)},k.race=function(c){return j(!0,c)},k.defer=y,c.Promise=k;var T=window.Promise;return/native code/.test(T)&&(T.prototype.done=v,T.prototype.fail=_,T.defer||(T.defer=y)),window.Promise=T||k});
;/*!/dep/avalon/validation/avalon.validation.js*/
define("dep/avalon/validation/avalon.validation",["avalon","dep/avalon/mmPromise/mmPromise"],function(a){function c(a){if(/^\d{15}$/.test(a))return!0;if(/^\d{17}[0-9xX]$/.test(a)){for(var c="1,0,x,9,8,7,6,5,4,3,2".split(","),g="7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2".split(","),v=a.toLowerCase().split(""),r=0,i=0;17>i;i++)r+=g[i]*v[i];return c[r%11]==v[17]}}function g(a){if("string"==typeof a&&a){var c=a.split("-");if(3===c.length&&4===c[0].length){var g=~~c[0],v=~~c[1]-1,A=~~c[2],d=new Date(g,v,A);return d.getFullYear()===g&&d.getMonth()===v&&d.getDate()===A}}return!1}function v(a){if(a.target)return a;var c={};for(var i in a)c[i]=a[i];var g=c.target=a.srcElement;if(0===a.type.indexOf("key"))c.which=null!=a.charCode?a.charCode:a.keyCode;else if(/mouse|click/.test(a.type)){var v=g.ownerDocument||document,A="BackCompat"===v.compatMode?v.body:v.documentElement;c.pageX=a.clientX+(A.scrollLeft>>0)-(A.clientLeft>>0),c.pageY=a.clientY+(A.scrollTop>>0)-(A.clientTop>>0),c.wheelDeltaY=c.wheelDelta,c.wheelDeltaX=0}return c.timeStamp=new Date-0,c.originalEvent=a,c.preventDefault=function(){a.returnValue=!1},c.stopPropagation=function(){a.cancelBubble=!0},c}function A(){var a=this.data||{};return this.message.replace(w,function(c,g){return null==a[g]?"":a[g]})}if(!a.duplexHooks)throw new Error("你的版本少于avalon1.3.7，不支持ms-duplex2.0，请使用avalon.validation.old.js");var b=/^([A-Z0-9]+[_|\_|\.]?)*[A-Z0-9]+@([A-Z0-9]+[_|\_|\.]?)*[A-Z0-9]+\.[A-Z]{2,3}$/i,h=/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i,F=/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i,y={cm:/^(?:0?1)((?:3[56789]|5[0124789]|8[278])\d|34[0-8]|47\d)\d{7}$/,cu:/^(?:0?1)(?:3[012]|4[5]|5[356]|8[356]\d|349)\d{7}$/,ce:/^(?:0?1)(?:33|53|8[079])\d{8}$/,cn:/^(?:0?1)[3458]\d{9}$/};a.mix(a.duplexHooks,{trim:{get:function(a,c){return"password"!==c.element.type&&(a=String(a||"").trim()),a}},required:{message:"必须填写",get:function(a,c,g){return g(""!==a),a}},norequired:{message:"可以不写",get:function(a,c,g){return g(!0),a}},"int":{message:"必须是整数",get:function(a,c,g){return g(/^\-?\d+$/.test(a)),a}},phone:{message:"手机号码不合法",get:function(a,c,g){var v=!1;for(var i in y)if(y[i].test(a)){v=!0;break}return g(v),a}},decimal:{message:"必须是小数",get:function(a,c,g){return g(/^\-?\d*\.?\d+$/.test(a)),a}},alpha:{message:"必须是字母",get:function(a,c,g){return g(/^[a-z]+$/i.test(a)),a}},alpha_numeric:{message:"必须为字母或数字",get:function(a,c,g){return g(/^[a-z0-9]+$/i.test(a)),a}},alpha_dash:{message:"必须为字母或数字及下划线等特殊字符",validate:function(a,c,g){return g(/^[a-z0-9_\-]+$/i.test(a)),a}},chs:{message:"必须是中文字符",get:function(a,c,g){return g(/^[\u4e00-\u9fa5]+$/.test(a)),a}},chs_numeric:{message:"必须是中文字符或数字及下划线等特殊字符",get:function(a,c,g){return g(/^[\\u4E00-\\u9FFF0-9_\-]+$/i.test(a)),a}},qq:{message:"腾讯QQ号从10000开始",get:function(a,c,g){return g(/^[1-9]\d{4,10}$/.test(a)),a}},id:{message:"身份证格式错误",get:function(a,g,v){return v(c(a)),a}},ipv4:{message:"ip地址不正确",get:function(a,c,g){return g(h.test(a)),a}},ipv6:{message:"ip地址不正确",get:function(a,c,g){return g(F.test(a)),a}},email:{message:"邮件地址错误",get:function(a,c,g){return g(b.test(a)),a}},url:{message:"URL格式错误",get:function(a,c,g){return g(/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(a)),a}},repeat:{message:"密码输入不一致",get:function(c,g,v){var A=g.element.getAttribute("data-duplex-repeat")||"",b=a(document.getElementById(A)).val()||"";return v(c===b),c}},date:{message:"必须符合日期格式 YYYY-MM-DD",get:function(a,c,v){return v(g(a)),a}},passport:{message:"护照格式错误或过长",get:function(a,c,g){return g(/^[a-zA-Z0-9]{4,20}$/i.test(a)),a}},minlength:{message:"最少输入{{min}}个字",get:function(a,c,g){var v=c.element,A=parseInt(v.getAttribute("minlength"),10);isFinite(A)||(A=parseInt(v.getAttribute("data-duplex-minlength"),10));var b=c.data.min=A;return g(a.length>=b),a}},maxlength:{message:"最多输入{{max}}个字",get:function(a,c,g){var v=c.element,A=parseInt(v.getAttribute("maxlength"),10);isFinite(A)||(A=parseInt(v.getAttribute("data-duplex-maxlength"),10));var b=c.data.max=A;return g(a.length<=b),a}},gt:{message:"必须大于{{max}}",get:function(a,c,g){var v=c.element,A=parseInt(v.getAttribute("max"),10);isFinite(A)||(A=parseInt(v.getAttribute("data-duplex-gt"),10));var b=c.data.max=A;return g(parseFloat(a)>b),a}},lt:{message:"必须小于{{min}}",get:function(a,c,g){var v=c.element,A=parseInt(v.getAttribute("min"),10);isFinite(A)||(A=parseInt(v.getAttribute("data-duplex-lt"),10));var b=c.data.min=A;return g(parseFloat(a)<b),a}},eq:{message:"必须等于{{eq}}",get:function(a,c,g){var v=c.element,A=parseInt(v.getAttribute("data-duplex-eq"),10),b=c.data.eq=A;return g(parseFloat(a)==b),a}},contains:{message:"必须包含{{array}}中的一个",get:function(a,c,g){var v=[].concat(a).map(String),A=(c.element.getAttribute("data-duplex-contains")||"").split(",");c.data.array=A;for(var b=!1,i=0,n=v.length;n>i;i++){var h=v[i];if(A.indexOf(h)>=0){b=!0;break}}return g(b),a}},contain:{message:"必须包含{{array}}",get:function(a,c,g){var v=[].concat(a).map(String),A=(c.element.getAttribute("data-duplex-contain")||"").split(",");if(c.data.array=A.join("与"),v.length){h=!0;for(var i=0,n=A.length;n>i;i++){var b=A[i];if(-1===v.indexOf(b)){h=!1;break}}}else var h=!1;return g(h),a}},pattern:{message:"必须匹配/{{pattern}}/这样的格式",get:function(a,c,g){var v=c.element,A=v.getAttribute("pattern"),b=v.getAttribute("data-duplex-pattern"),h=c.data.pattern=A||b,re=new RegExp("^(?:"+h+")$");return g(re.test(a)),a}}});var I=a.ui.validation=function(c,g,b){var h,F=g.validationOptions,y=a.define(g.validationId,function(g){a.mix(g,F),g.$skipArray=["widgetElement","data","validationHooks","validateInKeyup","validateAllInSubmit","resetInBlur"],g.widgetElement=c,g.data=[],g.$init=function(){c.setAttribute("novalidate","novalidate"),a.scan(c,[y].concat(b)),g.validateAllInSubmit&&(h=a.bind(c,"submit",function(e){e.preventDefault(),g.validateAll(g.onValidateAll)})),"function"==typeof F.onInit&&F.onInit.call(c,y,F,b)},g.$destory=function(){g.data=[],h&&a.unbind(c,"submit",h),c.textContent=c.innerHTML=""},g.validateAll=function(a){var c="function"==typeof a?a:g.onValidateAll,v=g.data.filter(function(a){var c=a.element;return c&&!c.disabled&&y.widgetElement.contains(c)}).map(function(a){return g.validate(a,!0)});Promise.all(v).then(function(a){for(var v,A=[],i=0;v=a[i++];)A=A.concat(v);if(g.deduplicateInValidateAll){var b={};A=A.filter(function(a){var c=a.element,g=c.getAttribute("data-validation-id");return g||(g=setTimeout("1"),c.setAttribute("data-validation-id",g)),b[g]?!1:(b[g]=!0,!0)})}c.call(g.widgetElement,A)})},g.resetAll=function(a){g.data.filter(function(a){return a.element}).forEach(function(a){try{g.onReset.call(a.element,{type:"reset"},a)}catch(e){}});var c="function"==typeof a?a:g.onResetAll;c.call(g.widgetElement)},g.validate=function(c,v,b){var h=c.valueAccessor(),F=y.validationHooks,I=a.duplexHooks,w=[],$=c.element;c.validateParam.replace(/\w+/g,function(a){var g=F[a]||I[a];if(!$.disabled){var v,b;w.push(new Promise(function(a,c){v=a,b=c}));var y=function(b){if(c.norequired&&""===h&&(b=!0),b)v(!0);else{var F={element:$,data:c.data,message:$.getAttribute("data-duplex-"+a+"-message")||$.getAttribute("data-duplex-message")||g.message,validateRule:a,getMessage:A};v(F)}};c.data={},g.get(h,c,y)}});var k=Promise.all(w).then(function(a){for(var c,A=[],i=0;c=a[i++];)"object"==typeof c&&A.push(c);return v||(A.length?g.onError.call($,A,b):g.onSuccess.call($,A,b),g.onComplete.call($,A,b)),A});return k},g.$watch("avalon-ms-duplex-init",function(A){var b=y.validationHooks;switch(A.valueAccessor=A.evaluator.apply(null,A.args),a.type(A.valueAccessor())){case"array":A.valueResetor=function(){this.valueAccessor([])};break;case"boolean":A.valueResetor=function(){this.valueAccessor(!1)};break;case"number":A.valueResetor=function(){this.valueAccessor(0)};break;default:A.valueResetor=function(){this.valueAccessor("")}}var h=a.duplexHooks;if("function"!=typeof A.pipe&&a.contains(c,A.element)){var F=[],I=[];if(A.param.replace(/\w+/g,function(a){var c=b[a]||h[a];c&&"function"==typeof c.get&&c.message?I.push(a):F.push(a),"norequired"===a&&(A.norequired=!0)}),A.validate=g.validate,A.param=F.join("-"),A.validateParam=I.join("-"),I.length){g.validateInKeyup&&A.bound("keyup",function(e){var a=A.element&&A.element.getAttribute("data-duplex-event");if(!a||/^(?:key|mouse|click|input)/.test(a)){var c=v(e);setTimeout(function(){g.validate(A,0,c)})}}),g.validateInBlur&&A.bound("blur",function(e){g.validate(A,0,v(e))}),g.resetInFocus&&A.bound("focus",function(e){g.onReset.call(A.element,v(e),A)});var w=g.data.filter(function(a){return a.element});a.Array.ensure(w,A),g.data=w}return!1}})});return y},w=/\\?{{([^{}]+)\}}/gm;I.defaults={validationHooks:{},onSuccess:a.noop,onError:a.noop,onComplete:a.noop,onValidateAll:a.noop,onReset:a.noop,onResetAll:a.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1}});